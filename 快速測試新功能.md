# Community Portal 新功能快速測試

## 更新完成 ✅

已部署到：`https://safe-net-tw.web.app/community`

---

## 新功能概覽

### 1️⃣ 新增長者 Popup
- 點擊「新增長者」→ 彈出 Modal
- 可直接選擇設備綁定
- 一次完成新增和綁定

### 2️⃣ 快速編輯
- 滑鼠移到長者卡片 → 右上角編輯按鈕
- 點擊 → 即時編輯
- 可變更設備綁定

### 3️⃣ 設備足跡
- 長者詳情頁面顯示活動記錄
- 時間範圍篩選
- 顯示位置和通知狀態

---

## 3 分鐘快速測試

### 測試 1: 新增長者（含設備綁定）

1. **訪問**：`https://safe-net-tw.web.app/community/elders`

2. **點擊「新增長者」**
   - ✅ 應該開啟 Modal（不是新頁面）

3. **填寫表單**：
   ```
   姓名: 測試長者
   性別: 男
   年齡: 75
   綁定設備: （從下拉選單選擇）
   ```

4. **檢查設備選項**：
   - ✅ 顯示「不綁定設備」
   - ✅ 顯示可用設備列表
   - ✅ 顯示設備數量提示

5. **選擇一個設備並提交**
   - ✅ Modal 關閉
   - ✅ 長者出現在列表
   - ✅ 卡片顯示設備資訊

---

### 測試 2: 快速編輯

1. **滑鼠移到剛新增的長者卡片**
   - ✅ 右上角出現編輯按鈕（鉛筆圖示）

2. **點擊編輯按鈕**
   - ✅ 開啟編輯 Modal
   - ✅ 顯示現有資料
   - ✅ 設備下拉選單顯示當前綁定

3. **修改資料**：
   - 改年齡為 76
   - 選擇不同的設備

4. **點擊「更新」**
   - ✅ Modal 關閉
   - ✅ 卡片顯示更新資料
   - ✅ 設備已變更

---

### 測試 3: 查看設備足跡

1. **點擊長者卡片**進入詳情

2. **向下滾動到「設備足跡」區塊**
   - ✅ 顯示活動記錄列表
   - ✅ 右上角有時間範圍選擇

3. **測試時間範圍**：
   - 切換到「最近 7 天」
   - ✅ 記錄數量變化

4. **查看記錄詳情**：
   - ✅ 位置名稱
   - ✅ 時間戳記
   - ✅ 信號強度
   - ✅ 通知狀態（如有）
   - ✅ 地圖連結（如有座標）

---

## 如果測試失敗

### Modal 沒有開啟

**檢查**：
1. 清除瀏覽器快取（Cmd+Shift+R）
2. 開啟開發者工具（F12）查看 Console 錯誤
3. 確認已部署最新版本

### 沒有可用設備

**顯示**：「目前沒有可用的設備」

**原因**：
- 該社區沒有設備，或
- 所有設備都已綁定

**解決**：
- 在 Admin「Beacon 管理」確認有設備
- 確認設備的 tags 包含社區 ID
- 確認設備的 bindingType 為 'UNBOUND'

### 編輯按鈕不出現

**原因**：您的角色是 MEMBER（不是 ADMIN）

**解決**：
- 在 Admin「SaaS 用戶管理」
- 將角色改為 ADMIN

### 設備足跡是空的

**原因**：設備最近沒有活動記錄

**建立測試資料**：
- 在 Admin「Line 通知測試」
- 選擇該長者的設備
- 發送測試資料
- 重新整理詳情頁面

---

## 功能演示

### 完整流程演示

```
步驟 1: 新增長者
  ↓
長者列表 → 新增長者（Modal）
  ↓
填寫資料 + 選擇設備
  ↓
提交 → 完成（設備已綁定）

步驟 2: 查看詳情
  ↓
點擊長者卡片
  ↓
看到基本資料 + 綁定設備 + 設備足跡

步驟 3: 快速編輯
  ↓
滑鼠移到卡片 → 點擊編輯
  ↓
修改資料 + 變更設備
  ↓
提交 → 完成

步驟 4: 測試通知
  ↓
Admin 發送測試資料
  ↓
LINE 收到通知
  ↓
設備足跡更新
```

---

## 與其他功能整合

### 通知點 + 設備足跡

1. 在通知點頁面勾選 gateway
2. 在 Admin 發送測試（長者經過該 gateway）
3. LINE 收到通知
4. **在設備足跡看到記錄**，標示「已發送通知」

### 設備清單 + 長者管理

1. 在設備清單查看可用設備
2. 記下設備資訊
3. 新增長者時選擇該設備
4. 設備清單顯示「已綁定（長者）」

---

## 建置資訊

- 建置時間：2026-01-25 22:36
- 檔案大小：660 KB (gzip: 203 KB)
- 部署文件：9 個

---

## 下一步

1. ✅ 測試新增長者（含設備選擇）
2. ✅ 測試快速編輯功能
3. ✅ 測試設備足跡顯示
4. ✅ 測試完整工作流程

---

**所有功能已完成並部署！**

立即訪問測試：`https://safe-net-tw.web.app/community/elders`
