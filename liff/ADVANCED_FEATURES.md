# LIFF åœ°åœ–é€²éšŽåŠŸèƒ½èªªæ˜Ž

æœ¬æ–‡æª”èªªæ˜Žä¸‰å€‹æ–°å¢žçš„é€²éšŽåŠŸèƒ½ã€‚

## 1. LINE Messaging API ç™¼é€é€šçŸ¥

### åŠŸèƒ½èªªæ˜Ž

ç•¶è¨­å‚™é€šéŽç”¨æˆ¶è¨­å®šçš„é€šçŸ¥é»žæ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•é€šéŽ LINE Messaging API ç™¼é€ Flex Message é€šçŸ¥çµ¦ç”¨æˆ¶ã€‚

### å¯¦ä½œç´°ç¯€

#### å¾Œç«¯å¯¦ä½œ

- **æª”æ¡ˆ**ï¼š`functions/src/line/sendMessage.ts`
- **æ–°å¢žå‡½æ•¸**ï¼š`sendNotificationPointAlert()`
- **è¨Šæ¯æ ¼å¼**ï¼šFlex Messageï¼ŒåŒ…å«ï¼š
  - é€šçŸ¥é»žåç¨±
  - è¨­å‚™æš±ç¨±
  - é€šéŽæ™‚é–“
  - åœ°åœ–é€£çµæŒ‰éˆ•

#### Beacon è™•ç†æ›´æ–°

- **æª”æ¡ˆ**ï¼š`functions/src/beacon/receiveBeaconData.ts`
- **å‡½æ•¸**ï¼š`handleLineUserNotification()`
- **æµç¨‹**ï¼š
  1. æª¢æŸ¥ Gateway æ˜¯å¦åœ¨ç”¨æˆ¶çš„é€šçŸ¥é»žåˆ—è¡¨ä¸­
  2. å‰µå»ºè­¦å ±è¨˜éŒ„ï¼ˆvisibleTo åªåŒ…å«è©²ç”¨æˆ¶ï¼‰
  3. èª¿ç”¨ `sendNotificationPointAlert()` ç™¼é€ LINE é€šçŸ¥
  4. éŒ¯èª¤è™•ç†ï¼šå¦‚æžœ LINE é€šçŸ¥å¤±æ•—ï¼Œä¸å½±éŸ¿è­¦å ±è¨˜éŒ„å‰µå»º

### Token ç²å–æ©Ÿåˆ¶

ç³»çµ±æœƒè‡ªå‹•å¾ž `tenants` é›†åˆè®€å– `lineChannelAccessToken`ï¼š

1. æŸ¥æ‰¾ Line ç”¨æˆ¶ç®¡ç†æ‰€å±¬çš„ tenantï¼š
   - å„ªå…ˆä½¿ç”¨ `line_users.joinedFromTenantId`
   - å¦‚æžœæ²’æœ‰ï¼Œå‰‡æŸ¥è©¢ `tenants/{tenantId}/members` æ‰¾åˆ°ç”¨æˆ¶çš„ membership

2. å¾ž tenant æ–‡æª”ä¸­ç²å– `lineChannelAccessToken`

3. ä½¿ç”¨è©² token ç™¼é€ LINE é€šçŸ¥

**ç¢ºä¿ tenant æ–‡æª”åŒ…å«ä»¥ä¸‹æ¬„ä½**ï¼š

```typescript
{
  lineChannelAccessToken: string,  // LINE Bot Channel Access Token
  // ... å…¶ä»–æ¬„ä½
}
```

### Flex Message ç¯„ä¾‹

```json
{
  "type": "flex",
  "altText": "é€šçŸ¥é»žè­¦å ±ï¼šæˆ‘çš„å®¶",
  "contents": {
    "type": "bubble",
    "header": {
      "type": "box",
      "layout": "vertical",
      "contents": [
        {
          "type": "text",
          "text": "é€šçŸ¥é»žè­¦å ±",
          "weight": "bold",
          "size": "lg",
          "color": "#FFFFFF"
        }
      ],
      "backgroundColor": "#4ECDC4"
    },
    "body": {
      "type": "box",
      "layout": "vertical",
      "contents": [...]
    },
    "footer": {
      "type": "box",
      "layout": "vertical",
      "contents": [
        {
          "type": "button",
          "style": "primary",
          "action": {
            "type": "uri",
            "label": "æŸ¥çœ‹åœ°åœ–",
            "uri": "https://www.google.com/maps?q=..."
          }
        }
      ]
    }
  }
}
```

## 2. çµ±è¨ˆåœ–è¡¨ï¼ˆæ´»å‹•è¶¨å‹¢ã€ç†±é»žåˆ†æžï¼‰

### åŠŸèƒ½èªªæ˜Ž

åœ¨ Bottom Sheet ä¸­æ·»åŠ çµ±è¨ˆåˆ†æžé¢æ¿ï¼Œç”¨æˆ¶å¯ä»¥å·¦å³æ»‘å‹•åœ¨ã€Œæ™‚é–“è»¸ã€å’Œã€Œçµ±è¨ˆåˆ†æžã€ä¹‹é–“åˆ‡æ›ã€‚

### å¯¦ä½œç´°ç¯€

#### çµ±è¨ˆå·¥å…·å‡½æ•¸

- **æª”æ¡ˆ**ï¼š`liff/src/utils/statisticsHelper.ts`
- **åŠŸèƒ½**ï¼š
  - `calculateHourlyActivity()` - è¨ˆç®—24å°æ™‚æ´»å‹•åˆ†å¸ƒ
  - `calculateDailyActivity()` - è¨ˆç®—è¿‘7å¤©æ´»å‹•è¶¨å‹¢
  - `calculateHotspots()` - è¨ˆç®—ç†±é–€åœ°é»ž TOP 5
  - `getPeakActivityTime()` - ç²å–é«˜å³°æ´»å‹•æ™‚æ®µ
  - `getMostVisitedGateway()` - ç²å–æœ€å¸¸åŽ»çš„åœ°é»ž
  - `getAverageActivitiesPerDay()` - è¨ˆç®—æ—¥å‡æ´»å‹•æ•¸

#### çµ±è¨ˆé¢æ¿çµ„ä»¶

- **æª”æ¡ˆ**ï¼š`liff/src/components/map/StatisticsPanel.tsx`
- **åŒ…å«å…§å®¹**ï¼š
  1. **æ‘˜è¦å¡ç‰‡**ï¼ˆ3å€‹ï¼‰
     - é«˜å³°æ™‚æ®µ
     - æ—¥å‡æ´»å‹•
     - æœ€å¸¸åŽ»çš„åœ°é»ž
  2. **24å°æ™‚æ´»å‹•åˆ†å¸ƒåœ–**
     - æŸ±ç‹€åœ–é¡¯ç¤ºæ¯å°æ™‚æ´»å‹•æ•¸
     - è—ç¶ è‰²æ¼¸è®Šæ•ˆæžœ
     - æ¯3å°æ™‚é¡¯ç¤ºä¸€æ¬¡æ™‚é–“æ¨™ç±¤
  3. **è¿‘7å¤©æ´»å‹•è¶¨å‹¢åœ–**
     - æŸ±ç‹€åœ–é¡¯ç¤ºæ¯å¤©æ´»å‹•æ•¸
     - ç²‰ç´…è‰²æ¼¸è®Šæ•ˆæžœ
     - é¡¯ç¤ºæ—¥æœŸæ¨™ç±¤
  4. **ç†±é–€åœ°é»ž TOP 5**
     - æŽ’ååœ–æ¨™ï¼ˆé‡‘ã€éŠ€ã€éŠ…ï¼‰
     - é€²åº¦æ¢é¡¯ç¤ºç™¾åˆ†æ¯”
     - é¡¯ç¤ºæ´»å‹•æ¬¡æ•¸

#### æ»‘å‹•åˆ‡æ›åŠŸèƒ½

- **æª”æ¡ˆ**ï¼š`liff/src/screens/map/MapScreen.tsx`
- **å¯¦ä½œ**ï¼š
  - ä½¿ç”¨ `useState` è¿½è¹¤ç•¶å‰é¢æ¿ï¼ˆtimeline/statisticsï¼‰
  - Touch äº‹ä»¶è™•ç†ï¼ˆonTouchStart, onTouchMove, onTouchEndï¼‰
  - æœ€å°æ»‘å‹•è·é›¢ï¼š50px
  - æ¨™ç±¤åˆ‡æ›æŒ‰éˆ•ï¼ˆðŸ“… æ™‚é–“è»¸ / ðŸ“Š çµ±è¨ˆåˆ†æžï¼‰

### ä½¿ç”¨æ–¹å¼

1. æ‰“é–‹ Bottom Sheet
2. é»žæ“Šé ‚éƒ¨æ¨™ç±¤åˆ‡æ›æˆ–å·¦å³æ»‘å‹•
3. å·¦æ»‘ï¼šæ™‚é–“è»¸ â†’ çµ±è¨ˆåˆ†æž
4. å³æ»‘ï¼šçµ±è¨ˆåˆ†æž â†’ æ™‚é–“è»¸

## 3. Gateway èšåˆé¡¯ç¤º

### åŠŸèƒ½èªªæ˜Ž

ç•¶ Gateway æ•¸é‡å¤šï¼ˆ>10å€‹ï¼‰æˆ–åœ°åœ–ç¸®æ”¾ç´šåˆ¥è¼ƒä½Žæ™‚ï¼Œç³»çµ±æœƒè‡ªå‹•å°‡ä½ç½®æŽ¥è¿‘çš„ Gateway èšåˆé¡¯ç¤ºï¼Œé¿å…åœ°åœ–éŽæ–¼æ“æ“ ã€‚

### å¯¦ä½œç´°ç¯€

#### èšåˆå·¥å…·å‡½æ•¸

- **æª”æ¡ˆ**ï¼š`liff/src/utils/clusterHelper.ts`
- **åŠŸèƒ½**ï¼š
  - `calculateDistance()` - è¨ˆç®—å…©é»žä¹‹é–“çš„è·é›¢ï¼ˆç±³ï¼‰
  - `clusterGateways()` - åŸºæ–¼è·é›¢é–¾å€¼èšåˆ Gateway
  - `getClusterThresholdByZoom()` - æ ¹æ“šç¸®æ”¾ç´šåˆ¥è¨ˆç®—èšåˆé–¾å€¼

#### èšåˆé–¾å€¼è¦å‰‡

| ç¸®æ”¾ç´šåˆ¥ | èšåˆè·é›¢é–¾å€¼ |
| -------- | ------------ |
| â‰¤ 10     | 10km         |
| 11-12    | 5km          |
| 13-14    | 1km          |
| 15-16    | 500m         |
| 17-18    | 100m         |
| â‰¥ 19     | 50m          |

#### æ¨™è¨˜æ›´æ–°é‚è¼¯

- **æª”æ¡ˆ**ï¼š`liff/src/hooks/useMapMarkers.ts`
- **èšåˆæ¢ä»¶**ï¼š
  - Gateway æ•¸é‡ > 10 å€‹
  - æˆ–ç¸®æ”¾ç´šåˆ¥ < 14
- **èšåˆé¡¯ç¤º**ï¼š
  - å–®å€‹ Gatewayï¼šæ­£å¸¸é¡¯ç¤ºï¼ˆåœ“å½¢åœ–æ¨™ï¼‰
  - å¤šå€‹ Gatewayï¼šé¡¯ç¤ºé›†ç¾¤åœ–æ¨™ï¼ˆåœ“å½¢ + æ•¸å­—ï¼‰
- **é›†ç¾¤åœ–æ¨™**ï¼š
  - å¤§å°ï¼šæ ¹æ“šæ•¸é‡å‹•æ…‹èª¿æ•´ï¼ˆ50-80pxï¼‰
  - é¡è‰²ï¼š
    - > 20 å€‹ï¼šç²‰ç´…è‰² #FF6A95
    - 10-20 å€‹ï¼šæ©˜è‰² #FFA500
    - < 10 å€‹ï¼šè—ç¶ è‰² #4ECDC4
  - é¡¯ç¤ºæ•¸é‡ï¼šç™½è‰²ç²—é«”æ•¸å­—

#### äº’å‹•è¡Œç‚º

- **é»žæ“Šé›†ç¾¤**ï¼š
  - å¦‚æžœç¸®æ”¾ç´šåˆ¥ < 18ï¼šæ”¾å¤§åœ°åœ–2ç´šä¸¦ç§»å‹•åˆ°é›†ç¾¤ä¸­å¿ƒ
  - å¦‚æžœç¸®æ”¾ç´šåˆ¥ â‰¥ 18ï¼šä¸åšä»»ä½•æ“ä½œï¼ˆæ‡‰è©²å·²ç¶“åˆ†æ•£é¡¯ç¤ºï¼‰
- **é»žæ“Šå–®å€‹ Gateway**ï¼šé¡¯ç¤ºè©³æƒ…å½ˆçª—ï¼ˆåŽŸæœ‰åŠŸèƒ½ï¼‰

### è¦–è¦ºæ•ˆæžœ

```
ç¸®æ”¾ç´šåˆ¥ 10-12ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ðŸ”µ 25         â”‚  â† é›†ç¾¤åœ–æ¨™ï¼ˆå¤§åœ“å½¢ + æ•¸å­—ï¼‰
â”‚                 â”‚
â”‚  ðŸ”µ 18    ðŸ”µ 12 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¸®æ”¾ç´šåˆ¥ 16-18ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        â”‚  â† å€‹åˆ¥ Gatewayï¼ˆæ­£å¸¸åœ–æ¨™ï¼‰
â”‚           â”‚
â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•ˆèƒ½å„ªåŒ–

- ç›£è½åœ°åœ– `zoom_changed` äº‹ä»¶
- ç¸®æ”¾è®ŠåŒ–æ™‚è‡ªå‹•é‡æ–°è¨ˆç®—èšåˆ
- æ¸…é™¤èˆŠæ¨™è¨˜é¿å…å…§å­˜æ´©æ¼

## éƒ¨ç½²èˆ‡æ¸¬è©¦

### éƒ¨ç½²æ­¥é©Ÿ

```bash
# 1. ç¢ºä¿ tenant æ–‡æª”æœ‰ lineChannelAccessToken
# åœ¨ Firebase Console æˆ–é€šéŽ admin å¾Œå°è¨­å®š

# 2. éƒ¨ç½²å¾Œç«¯
cd functions
npm run build
firebase deploy --only functions

# 3. éƒ¨ç½²å‰ç«¯
cd liff
npm run build
firebase deploy --only hosting
```

### æ¸¬è©¦æª¢æŸ¥æ¸…å–®

#### LINE é€šçŸ¥æ¸¬è©¦

- [ ] ç¶å®šè¨­å‚™
- [ ] è¨­å®šé€šçŸ¥é»ž
- [ ] æ¨¡æ“¬è¨­å‚™é€šéŽé€šçŸ¥é»žï¼ˆç™¼é€ Beacon æ•¸æ“šï¼‰
- [ ] ç¢ºèª LINE æ”¶åˆ°é€šçŸ¥
- [ ] æª¢æŸ¥ Flex Message æ ¼å¼
- [ ] æ¸¬è©¦åœ°åœ–é€£çµæ˜¯å¦æ­£ç¢º

#### çµ±è¨ˆåœ–è¡¨æ¸¬è©¦

- [ ] æŸ¥çœ‹æœ‰æ´»å‹•è¨˜éŒ„çš„è¨­å‚™
- [ ] é»žæ“Šã€Œçµ±è¨ˆåˆ†æžã€æ¨™ç±¤
- [ ] å·¦æ»‘åˆ‡æ›åˆ°çµ±è¨ˆåˆ†æž
- [ ] å³æ»‘åˆ‡æ›å›žæ™‚é–“è»¸
- [ ] ç¢ºèª24å°æ™‚åˆ†å¸ƒåœ–æ­£ç¢º
- [ ] ç¢ºèª7å¤©è¶¨å‹¢åœ–æ­£ç¢º
- [ ] ç¢ºèªç†±é–€åœ°é»ž TOP 5 æ­£ç¢º
- [ ] æ¸¬è©¦ç„¡æ´»å‹•è¨˜éŒ„æ™‚çš„é¡¯ç¤º

#### Gateway èšåˆæ¸¬è©¦

- [ ] æ·»åŠ  10+ å€‹ Gatewayï¼ˆä½ç½®æŽ¥è¿‘ï¼‰
- [ ] ç¸®æ”¾åˆ°ç´šåˆ¥ 12ï¼Œç¢ºèªé¡¯ç¤ºèšåˆåœ–æ¨™
- [ ] é»žæ“Šèšåˆåœ–æ¨™ï¼Œç¢ºèªåœ°åœ–æ”¾å¤§
- [ ] ç¸®æ”¾åˆ°ç´šåˆ¥ 18ï¼Œç¢ºèªé¡¯ç¤ºå€‹åˆ¥ Gateway
- [ ] æ¸¬è©¦ä¸åŒç¸®æ”¾ç´šåˆ¥çš„èšåˆè¡Œç‚º
- [ ] ç¢ºèªèšåˆåœ–æ¨™é¡è‰²éš¨æ•¸é‡è®ŠåŒ–

## å·²çŸ¥é™åˆ¶èˆ‡æœªä¾†æ”¹é€²

### å·²çŸ¥é™åˆ¶

1. **LINE é€šçŸ¥**ï¼šéœ€è¦è¨­å®š LINE Channel Access Token
2. **çµ±è¨ˆåœ–è¡¨**ï¼šåªé¡¯ç¤ºæœ€è¿‘100ç­†æ´»å‹•è¨˜éŒ„
3. **Gateway èšåˆ**ï¼šç°¡å–®çš„è·é›¢èšåˆç®—æ³•ï¼Œå¯èƒ½åœ¨é‚Šç•Œæƒ…æ³ä¸‹ä¸å¤ æº–ç¢º

### æœªä¾†æ”¹é€²æ–¹å‘

1. **LINE é€šçŸ¥**ï¼š
   - æ”¯æ´é€šçŸ¥åå¥½è¨­å®šï¼ˆéœéŸ³æ™‚æ®µã€é€šçŸ¥é »çŽ‡ï¼‰
   - æ”¯æ´é€šçŸ¥æ­·å²æŸ¥è©¢
   - æ”¯æ´å¤šèªžè¨€é€šçŸ¥

2. **çµ±è¨ˆåœ–è¡¨**ï¼š
   - æ·»åŠ æ™‚é–“ç¯„åœé¸æ“‡å™¨
   - æ·»åŠ æ›´å¤šçµ±è¨ˆæŒ‡æ¨™ï¼ˆç§»å‹•è·¯ç·šã€åœç•™æ™‚é–“ç­‰ï¼‰
   - å°Žå‡ºçµ±è¨ˆå ±å‘Šï¼ˆPDF/CSVï¼‰
   - æ·»åŠ æ¯”è¼ƒåŠŸèƒ½ï¼ˆæœ¬é€± vs ä¸Šé€±ï¼‰

3. **Gateway èšåˆ**ï¼š
   - ä½¿ç”¨æ›´é€²éšŽçš„èšåˆç®—æ³•ï¼ˆK-meansã€DBSCANï¼‰
   - æ”¯æ´è‡ªå®šç¾©èšåˆé–¾å€¼
   - èšåˆåœ–æ¨™é¡¯ç¤ºé¡žåž‹åˆ†å¸ƒï¼ˆé¤…åœ–ï¼‰
   - é»žæ“Šèšåˆé¡¯ç¤º Gateway åˆ—è¡¨å½ˆçª—

## æŠ€è¡“æž¶æ§‹ç¸½çµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯ (LIFF)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MapScreen.tsx                                            â”‚
â”‚   â”œâ”€ æ»‘å‹•åˆ‡æ›é¢æ¿ (timeline/statistics)                  â”‚
â”‚   â”œâ”€ StatisticsPanel.tsx (çµ±è¨ˆåœ–è¡¨)                     â”‚
â”‚   â””â”€ useMapMarkers.ts (èšåˆé¡¯ç¤º)                        â”‚
â”‚       â””â”€ clusterHelper.ts (èšåˆç®—æ³•)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ statisticsHelper.ts (çµ±è¨ˆè¨ˆç®—)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å¾Œç«¯ (Cloud Functions)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ receiveBeaconData.ts                                     â”‚
â”‚   â””â”€ handleLineUserNotification()                       â”‚
â”‚       â”œâ”€ æª¢æŸ¥é€šçŸ¥é»ž                                      â”‚
â”‚       â”œâ”€ å‰µå»ºè­¦å ±è¨˜éŒ„                                    â”‚
â”‚       â””â”€ ç™¼é€ LINE é€šçŸ¥                                  â”‚
â”‚           â””â”€ sendNotificationPointAlert()               â”‚
â”‚               (sendMessage.ts)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     è³‡æ–™æµ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Beacon æ•¸æ“š                                              â”‚
â”‚   â†“                                                      â”‚
â”‚ æª¢æŸ¥ LINE_USER ç¶å®š                                      â”‚
â”‚   â†“                                                      â”‚
â”‚ æª¢æŸ¥é€šçŸ¥é»ž (inheritedNotificationPointIds)              â”‚
â”‚   â†“                                                      â”‚
â”‚ å‰µå»ºè­¦å ± (alerts é›†åˆ)                                   â”‚
â”‚   â†“                                                      â”‚
â”‚ ç™¼é€ LINE é€šçŸ¥ (Flex Message)                           â”‚
â”‚   â†“                                                      â”‚
â”‚ è¨˜éŒ„æ´»å‹• (devices/{id}/activities)                      â”‚
â”‚   â†“                                                      â”‚
â”‚ å‰ç«¯å³æ™‚æ›´æ–° (Firestore è¨‚é–±)                           â”‚
â”‚   â†“                                                      â”‚
â”‚ æ›´æ–°çµ±è¨ˆåœ–è¡¨                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ”¯æ´èˆ‡ç¶­è­·

å¦‚æœ‰å•é¡Œæˆ–éœ€è¦å”åŠ©ï¼Œè«‹åƒè€ƒï¼š

- [åŸºç¤ŽåŠŸèƒ½æ–‡æª”](./LIFF_MAP_IMPLEMENTATION.md)
- Firebase Consoleï¼šæŸ¥çœ‹ Functions æ—¥èªŒ
- LINE Developers Consoleï¼šæŸ¥çœ‹ Messaging API ç‹€æ…‹
